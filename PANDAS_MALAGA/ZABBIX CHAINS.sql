SELECT STATUS FROM DBA_SCHEDULER_JOB_LOG WHERE     LOG_DATE = (SELECT MAX (LOG_DATE) FROM DBA_SCHEDULER_JOB_LOG WHERE Owner = 'MSTR_QUIROFANO' AND job_name = 'ETL_LOAD_INTERV_P001_MT' AND OPERATION = 'CHAIN_RUN') AND Owner = 'MSTR_QUIROFANO' AND job_name = 'ETL_LOAD_INTERV_P001_MT' AND OPERATION = 'CHAIN_RUN';

SELECT epoch (ACTUAL_START_DATE) last_start_epoch FROM DBA_SCHEDULER_JOB_LOG LEFT JOIN DBA_SCHEDULER_JOB_RUN_DETAILS USING (LOG_ID) WHERE     DBA_SCHEDULER_JOB_LOG.LOG_DATE = (SELECT MAX (LOG_DATE) FROM DBA_SCHEDULER_JOB_LOG WHERE Owner = 'MSTR_QUIROFANO' AND job_name = 'ETL_LOAD_INTERV_P001_MT' AND OPERATION = 'CHAIN_RUN') AND DBA_SCHEDULER_JOB_LOG.Owner = 'MSTR_QUIROFANO' AND DBA_SCHEDULER_JOB_LOG.job_name = 'ETL_LOAD_INTERV_P001_MT' AND OPERATION = 'CHAIN_RUN';

SELECT EXTRACT (DAY FROM RUN_DURATION) * 86400 + EXTRACT (HOUR FROM RUN_DURATION) * 3600 + EXTRACT (MINUTE FROM RUN_DURATION) * 60 + EXTRACT (SECOND FROM RUN_DURATION) RD FROM DBA_SCHEDULER_JOB_LOG LEFT JOIN DBA_SCHEDULER_JOB_RUN_DETAILS USING (LOG_ID) WHERE     DBA_SCHEDULER_JOB_LOG.LOG_DATE = (SELECT MAX (LOG_DATE) FROM DBA_SCHEDULER_JOB_LOG WHERE Owner = 'MSTR_QUIROFANO' AND job_name = 'ETL_LOAD_INTERV_P001_MT' AND OPERATION = 'CHAIN_RUN') AND DBA_SCHEDULER_JOB_LOG.Owner = 'MSTR_QUIROFANO' AND DBA_SCHEDULER_JOB_LOG.job_name = 'ETL_LOAD_INTERV_P001_MT' AND OPERATION = 'CHAIN_RUN';

SELECT JOB_SUBNAME || ' ' || STATUS || ' ,' FAILED_STEPS FROM DBA_SCHEDULER_JOB_LOG WHERE     JOB_NAME = 'ETL_LOAD_INTERV_P001_MT' AND OPERATION = 'RUN' AND STATUS NOT IN ('SUCCEEDED') AND LOG_ID BETWEEN (SELECT MAX (L1.LOG_ID) LAST_RUN_START FROM DBA_SCHEDULER_JOB_LOG L1 WHERE OWNER = 'MSTR_QUIROFANO' AND JOB_NAME = 'ETL_LOAD_INTERV_P001_MT' AND OPERATION = 'CHAIN_START') AND (SELECT MAX (L1.LOG_ID) LAST_RUN_STOP FROM DBA_SCHEDULER_JOB_LOG L1 WHERE OWNER = 'MSTR_QUIROFANO' AND JOB_NAME = 'ETL_LOAD_INTERV_P001_MT' AND OPERATION = 'CHAIN_RUN');

--SELECT NATID_AREA_HOSPITALARIA || ' no se ha cargado, ' A FROM    (SELECT RESULT, NATID_AREA_HOSPITALARIA FROM MSTR_HOSPITALIZACION.MSTR_UTL_LOG_CARGAS WHERE TRUNC (TS_LOG) = TRUNC (SYSDATE) AND RESULT = 'Completada carga Altas ') RIGHT JOIN (SELECT NATID_AREA_HOSPITALARIA FROM MSTR_HOSPITALIZACION.MSTR_UTL_LOCAL_CODIGOS WHERE ENABLED = 1) USING (NATID_AREA_HOSPITALARIA) WHERE RESULT IS NULL;
